<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario de Intervención</title>
  <link rel="stylesheet" href="estilos.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>

</head>

<body>
  <div class="container">
    <header>
      <h1>Formulario de Intervención</h1>
      <p>Por favor, complete los datos a continuación para registrar la intervención.</p>
    </header>

    <form id="formulario" onsubmit="guardarDatos(event)">
      <div class="form-group">
        <label for="nCliente">Número de Cliente</label>
        <input type="text" id="nCliente" required>
      </div>

      <div class="form-group">
        <label for="razonSocial">Razón Social</label>
        <input type="text" id="razonSocial" required>
      </div>

      <div class="form-group">
        <label for="direccion">Dirección</label>
        <input type="text" id="direccion">
      </div>

      <div class="form-group">
        <label for="ciudad">Ciudad</label>
        <select id="ciudad">
          <option>Almirante Brown</option>
          <option>Avellaneda</option>
          <option>Berazategui</option>
          <option>Esteban Echeverria</option>
          <option>Ezeiza</option>
          <option>Florencio Varela</option>
          <option>CABA</option>
          <option>Lanus</option>
          <option>Lomas de Zamora</option>
          <option>Presidente Peron</option>
          <option>Quilmes</option>
          <option>San Vicente</option>
        </select>
      </div>

      <div class="form-group">
        <label for="tipoCliente">Tipo de Cliente</label>
        <select id="tipoCliente">
          <option>Comercio</option>
          <option>Industria</option>
          <option>GNC</option>
        </select>
      </div>

      <div class="form-group">
        <label for="tipoOperacion">Tipo de Operación</label>
        <select id="tipoOperacion" onchange="mostrarCamposOperacion()">
          <option value="Calibracion">Calibración</option>
          <option value="CambioEquipo">Cambio de Equipo</option>
        </select>
      </div>

      <div id="calibracionCampos" class="form-group" style="display:none;">
        <label>Opciones de Calibración</label><br>
        <input type="checkbox" id="calibracionPresion"> Calibración de Presión
        <input type="checkbox" id="calibracionTemperatura"> Calibración de Temperatura
        <input type="checkbox" id="cambioBateria"> Cambio de Batería de Respaldo
        <input type="checkbox" id="cambioContador"> Cambio de Contador Mecánico
        <input type="checkbox" id="cambioDisplay"> Cambio de Display
        <input type="checkbox" id="cambioPlaca"> Cambio de Placa
        <input type="checkbox" id="cambioPlacaPulsos"> Cambio de Placa de Pulsos
        <input type="checkbox" id="cambioPuerto"> Cambio de Puerto de Comunicación
        <input type="checkbox" id="cambioPuertoInterfaz"> Cambio de Puerto Interfaz
        <input type="checkbox" id="cambioRotor"> Cambio de Rotor
        <input type="checkbox" id="cambioSensorPresion"> Cambio de Sensor Presión
        <input type="checkbox" id="cambioSensorTemperatura"> Cambio de Sensor Temperatura
        <input type="checkbox" id="cambioTeclado"> Cambio de Teclado
        <input type="checkbox" id="cambioPackPilas"> Cambio Pack Pilas
        <input type="checkbox" id="configuracionUC"> Configuración de UC

        <div class="form-group">
          <label for="nSerieUC">N° de Serie UC</label>
          <input type="text" id="nSerieUC">
        </div>

        <div class="form-group">
          <label for="marcaModeloUC">Marca/Modelo UC</label>
          <select id="marcaModeloUC">
            <option>ELGAS</option>
            <option>MERCURY ECAT PT RANGO 0-1</option>
            <option>MERCURY ECAT PT RANGO 0-4</option>
            <option>MERCURY ECAT PT RANGO 0-7</option>
            <option>MERCURY ECAT PT RANGO 0-20</option>
            <option>MERCURY MINI MAX AT PT 0-20</option>
          </select>
        </div>
      </div>

      <div id="cambioEquipoCampos" class="form-group" style="display:none;">
        <label for="nSerieUC">N° de Serie UC Reemplazo</label>
        <input type="text" id="nSerieUC">

        <label for="marcaModeloUC">Marca/Modelo UC Reemplazo</label>
        <select id="marcaModeloUC">
          <option>ELGAS</option>
          <option>MERCURY ECAT PT RANGO 0-1</option>
          <option>MERCURY ECAT PT RANGO 0-4</option>
          <option>MERCURY ECAT PT RANGO 0-7</option>
          <option>MERCURY ECAT PT RANGO 0-20</option>
          <option>MERCURY MINI MAX AT PT 0-20</option>
        </select>
      </div>

      <button type="submit">Guardar Datos</button>
    </form>

    <div class="search-container">
      <input type="text" id="searchInput" placeholder="Buscar por cliente o razón social..." onkeyup="searchTable()">
    </div>

    <h2 id="historial">Historial de Intervenciones</h2>

    <table id="tablaDatos">
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Razón Social</th>
          <th>Tipo de Cliente</th>
          <th>Tipo de Operación</th>
          <th>Fecha de Intervención</th>
          <th>Próxima Fecha de Intervención</th>
          <th>Usuario</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <button id="exportarBtn" onclick="exportToExcel()">Exportar a Excel</button>
  </div>

  <script src="script.js"></script>
</body>
</html>
